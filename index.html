<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IscoTech Hub | Automated Career & Academy Portal</title>
    <script src="https://unpkg.com/intasend-inlinejs-sdk@3.0.4/build/intasend-inline.js"></script>
    <style>
        :root { --navy: #000814; --gold: #ffc300; --mpesa: #28a745; --light: #f8f9fa; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--light); margin: 0; }
        header { background: var(--navy); color: white; padding: 50px 20px; text-align: center; border-bottom: 4px solid var(--gold); }
        .container { max-width: 900px; margin: 30px auto; padding: 0 20px; }
        .card { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); margin-bottom: 25px; }
        h2 { color: var(--navy); border-left: 5px solid var(--gold); padding-left: 15px; margin-top: 0; }
        .fee-tag { background: #eef2ff; color: #4338ca; padding: 5px 12px; border-radius: 20px; font-size: 0.85em; font-weight: bold; }
        label { display: block; margin: 15px 0 5px; font-weight: 600; }
        input, select { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 1em; box-sizing: border-box; }
        .btn { width: 100%; padding: 15px; background: var(--mpesa); color: white; border: none; border-radius: 8px; font-size: 1.1em; font-weight: bold; cursor: pointer; transition: 0.3s; margin-top: 15px; }
        .btn:hover { background: #218838; transform: translateY(-2px); }
        .status { text-align: center; font-size: 0.9em; margin-top: 10px; color: #555; font-style: italic; }
        .results-box { display: none; margin-top: 25px; padding: 20px; background: #f0fff4; border: 2px dashed var(--mpesa); border-radius: 10px; }
        .course-item { background: white; padding: 10px; margin-bottom: 8px; border-radius: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); list-style: none; }
    </style>
</head>
<body>

<header>
    <h1>ISCOTECH HUB PORTAL</h1>
    <p>Empowering Your Future through ICT & Automation</p>
</header>

<div class="container">

    <div class="card">
        <h2>1. Career AI Analysis <span class="fee-tag">KES 50</span></h2>
        <p>Get 7 high-demand career paths based on your grade.</p>
        
        <label>Your Mean Grade:</label>
        <select id="careerGrade">
            <option value="C">C (Plain)</option>
            <option value="C-">C- (Minus)</option>
            <option value="D">D (Plain/Plus)</option>
        </select>

        <label>M-Pesa Phone Number:</label>
        <input type="number" id="careerPhone" placeholder="2547XXXXXXXX">
        
        <button class="btn" onclick="triggerPayment(50, 'careerPhone', 'career-output', unlockCareerResults)">
            PAY & UNLOCK ANALYSIS
        </button>
        <div id="status-careerPhone" class="status"></div>

        <div id="career-output" class="results-box">
            <h3 style="color:var(--mpesa);">Analysis Results ‚úÖ</h3>
            <ul id="courseList" style="padding:0;"></ul>
            <button class="btn" style="background:var(--navy); margin-top:15px;" onclick="window.print()">Download Results</button>
        </div>
    </div>

    <div class="card">
        <h2>2. IscoTech Academy <span class="fee-tag">KES 50</span></h2>
        <p>Enroll in Masterclasses: Python, Full-Stack Web Dev, or Cybersecurity.</p>
        
        <label>Select Course:</label>
        <select id="academyCourse">
            <option>Python Data Science</option>
            <option>Full-Stack Web Development</option>
            <option>Cybersecurity Essentials</option>
        </select>

        <label>M-Pesa Phone Number:</label>
        <input type="number" id="academyPhone" placeholder="2547XXXXXXXX">
        
        <button class="btn" onclick="triggerPayment(50, 'academyPhone', 'academy-output')">
            PAY & ENROLL NOW
        </button>
        <div id="status-academyPhone" class="status"></div>

        <div id="academy-output" class="results-box">
            <h3 style="color:var(--mpesa);">Enrollment Successful ‚úÖ</h3>
            <p>Welcome! Your student ID has been generated. Please join the student portal below:</p>
            <a href="https://wa.me/254746939408?text=I_have_paid_for_Academy" class="btn" style="background:var(--navy); text-decoration:none;">ACCESS CLASSROOM</a>
        </div>
    </div>

    <div class="card">
        <h2>3. KUCCPS / HEF / KRA <span class="fee-tag">KES 20</span></h2>
        <p>Unlock fast-track assistance for government portal services.</p>
        
        <label>M-Pesa Phone Number:</label>
        <input type="number" id="govtPhone" placeholder="2547XXXXXXXX">
        
        <button class="btn" onclick="triggerPayment(20, 'govtPhone', 'govt-output')">
            PAY & UNLOCK SERVICE
        </button>
        <div id="status-govtPhone" class="status"></div>

        <div id="govt-output" class="results-box">
            <h3 style="color:var(--mpesa);">Service Unlocked ‚úÖ</h3>
            <p>An agent is ready to assist you. Click the button below to start your application.</p>
            <a href="https://wa.me/254746939408?text=Service_Unlocked_Help_Me" class="btn" style="background:var(--navy); text-decoration:none;">CHAT WITH AGENT</a>
        </div>
    </div>

</div>

<script>
    // INITIALIZE INTASEND WITH YOUR LIVE KEY
    const intasend = new window.IntaSend({
        publicAPIKey: "ISPubKey_live_546f4dab-3bfd-45d1-9c94-cb3d3767e690",
        live: true 
    });

    function triggerPayment(amount, phoneInputId, outputId, extraFunction) {
        const phone = document.getElementById(phoneInputId).value;
        const statusBox = document.getElementById('status-' + phoneInputId);

        if(!phone || phone.length < 10) {
            alert("Please enter a valid M-Pesa number (e.g., 254712345678)");
            return;
        }

        statusBox.innerHTML = "Requesting M-Pesa PIN prompt... üì≤";

        intasend.run({
            amount: amount,
            currency: "KES",
            phone_number: phone,
            method: "M-PESA"
        })
        .on("COMPLETE", (results) => {
            statusBox.innerHTML = "Payment Successful! ‚úÖ";
            document.getElementById(outputId).style.display = "block";
            document.getElementById(outputId).scrollIntoView({ behavior: 'smooth' });
            if(extraFunction) extraFunction();
        })
        .on("FAILED", () => {
            statusBox.innerHTML = "Payment failed. Please try again. ‚ùå";
        })
        .on("IN-PROGRESS", () => {
            statusBox.innerHTML = "Check your phone and enter M-Pesa PIN... ‚è≥";
        });
    }

    function unlockCareerResults() {
        const grade = document.getElementById('careerGrade').value;
        const list = document.getElementById('courseList');
        let courses = [];

        if (grade === "C") {
            courses = ["Dip. ICT & Cyber Security", "Dip. Clinical Medicine", "Dip. Software Engineering", "Dip. Pharmacy", "Dip. Electrical Engineering", "Dip. Business Information Technology", "Dip. Nursing"];
        } else if (grade === "C-") {
            courses = ["Dip. Health Records", "Cert. in Computer Science", "Dip. Community Health", "Dip. Automotive Tech", "Dip. Building Construction", "Cert. in Web Design", "Dip. Hospitality Management"];
        } else {
            courses = ["Cert. in ICT Basics", "Cert. in Plumbing", "Cert. in Electrical Installation", "Cert. in Graphic Design", "Artisan in Masonry", "Cert. in Food & Beverage", "Cert. in Hairdressing"];
        }

        list.innerHTML = "";
        courses.forEach(course => {
            list.innerHTML += `<li class="course-item">‚≠ê <b>${course}</b></li>`;
        });
    }
</script>

</body>
</html>
